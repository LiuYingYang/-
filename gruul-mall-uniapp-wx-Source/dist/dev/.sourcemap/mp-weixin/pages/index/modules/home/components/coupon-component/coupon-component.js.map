{"version":3,"sources":["webpack:///./src/pages/index/modules/home/components/coupon-component/coupon-component.vue?0480","webpack:///./src/pages/index/modules/home/components/coupon-component/coupon-component.vue?f957","webpack:///./src/pages/index/modules/home/components/coupon-component/coupon-component.vue?e3b7","webpack:///./src/pages/index/modules/home/components/coupon-component/coupon-component.vue?02a9","uni-app:///src/pages/index/modules/home/components/coupon-component/coupon-component.vue?vue&type=script&lang=ts&","webpack:///./src/pages/index/modules/home/components/coupon-component/coupon-component.vue?f95b","webpack:///./src/pages/index/modules/home/components/coupon-component/coupon-component.vue?d90f"],"names":[],"mappings":"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","file":"pages/index/modules/home/components/coupon-component/coupon-component.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./coupon-component.vue?vue&type=template&id=65b8b9f8&scoped=true&\"\nvar renderjs\nimport script from \"./coupon-component.vue?vue&type=script&lang=ts&\"\nexport * from \"./coupon-component.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./coupon-component.vue?vue&type=style&index=0&id=65b8b9f8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"65b8b9f8\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/modules/home/components/coupon-component/coupon-component.vue\"\nexport default component.exports","export * from \"-!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./coupon-component.vue?vue&type=template&id=65b8b9f8&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../../node_modules/ts-loader/index.js??ref--14-1!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--14-2!../../../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./coupon-component.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../../node_modules/ts-loader/index.js??ref--14-1!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--14-2!../../../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./coupon-component.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {\n  Component,\n  Vue,\n  Prop,\n  Watch\n} from 'vue-property-decorator'\nimport {\n  getCouponCoup,\n  getOneCoupon\n} from \"@/api/modules/coupon\";\nimport {CouponStateType,CouponPropType,ApiCouponList} from \"./couponType\"\n@Component({})\nexport default class CouponComponent extends Vue implements CouponStateType {\n  @Prop({\n    type: Object\n  })\n  couponType: CouponPropType;\n\n  couponList:ApiCouponList[]=[]\n  isShow = false\n  authType = false\n  canGet = true\n  formData:CouponPropType\n  allHide = false\n\n  @Watch(\"couponType\",{\n    immediate:true\n  })\n  onPropUpdate(e) {\n    this.formData = e\n  }\n\n  // 组件周期函数--监听组件挂载完毕\n  mounted() {\n    if (this.$STORE.userStore.userInfo.token) {\n      this.getCouponList();\n      this.isShow = false,\n        this.$emit(\"stopRoll\", this.isShow);\n    } else {\n      this.appLaunchInit();\n    }\n  }\n\n  appLaunchInit() {\n    this.$Pubsub.on(\"app-launch\", () => {\n      this.getCouponList();\n      let userinfo = {\n        ...this.$STORE.userStore.userInfo,\n        couponType: false\n      }\n      this.$STORE.userStore.setUserInfo(userinfo)\n      this.isShow = true,\n        this.$emit(\"stopRoll\", this.isShow);\n    });\n  }\n\n  /**\n   * 获取首页优惠券\n   */\n  getCouponList() {\n    const components = this.$STORE.setStore.components;\n    const couponItem = components.filter(item => item.value === \"Coupon\");\n    if (couponItem.length === 0) {\n      return;\n    }\n    const hide = couponItem[0].formData.hide;\n    getCouponCoup({}).then(res => {\n      if (!res.length) return this.$emit(\"stopRoll\", false);\n      res = this.filterList(res);\n      if (hide) {\n        const resdata = JSON.parse(JSON.stringify(res));\n        res = resdata.filter(item => {\n          return item.restNum !== 0;\n        });\n      }\n      this.allHide = res.length === 0 ? true : false\n      this.couponList = res\n      this.canGet = true\n    });\n  }\n\n  /**\n   * 过滤优惠券数据\n   */\n  filterList(res) {\n    const list = res.filter((item, index) => {\n      item.hasUse =\n        item.totalAvailable > 0 && item.available > 0 ? false : true;\n      item.index = index;\n      item.restNum =\n        item.available > item.totalAvailable ?\n        item.totalAvailable :\n        item.available;\n      return this.formData.hide ? item.available : true;\n    });\n    return [...list];\n  }\n\n  /**\n   * 领取优惠券\n   * @param options\n   */\n  getCoupon(options) {\n    const {\n      index,\n      id,\n      hasuse\n    } = options.currentTarget.dataset;\n    const userInfo = this.$STORE.userStore.userInfo;\n    if (hasuse) return;\n    if (!userInfo.whetherAuthorization) {\n      this.authType = true\n      this.isShow = false\n      return;\n    }\n    const currentItem = this.couponList[index];\n    getOneCoupon(id, {})\n      .then(() => {\n        currentItem.restNum = currentItem.restNum - 1;\n        if (currentItem.restNum === 0) {\n          currentItem.hasUse = !currentItem.hasUse;\n        }\n        this.couponList[index] = currentItem,\n          uni.showToast({\n            title: \"领取成功\",\n            icon: \"none\",\n            duration: 500\n          });\n      })\n      .catch(() => {\n        uni.showToast({\n          title: \"优惠券已被领光\",\n          icon: \"none\",\n          duration: 1000\n        });\n        currentItem.hasUse = !currentItem.hasUse;\n        this.couponList[index] = currentItem\n      });\n  }\n}\n","import mod from \"-!../../../../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./coupon-component.vue?vue&type=style&index=0&id=65b8b9f8&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./coupon-component.vue?vue&type=style&index=0&id=65b8b9f8&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1628754989660\n      var cssReload = require(\"E:/代码/group-shop-uniapp-wx-Source/node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}