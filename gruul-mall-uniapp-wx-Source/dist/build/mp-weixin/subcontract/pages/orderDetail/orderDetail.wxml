<wxs src="../../../wxs/afterSale.wxs" module="after"></wxs>
<wxs src="../../../wxs/customForm.wxs" module="formHelper"></wxs>
<wxs src="./helper.wxs" module="helper"></wxs>
<wxs src="../order/order.wxs" module="order"></wxs>
<view class="order__detail data-v-a9ca07ae"><van-toast vue-id="bf89dbc6-1" id="van-toast" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-toast><van-dialog vue-id="bf89dbc6-2" confirm-button-color="#fe4e63" id="van-dialog" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-dialog><view class="order--status data-v-a9ca07ae"><block class="data-v-a9ca07ae"><block wx:if="{{order.isClose(detail.status)}}"><view class="data-v-a9ca07ae"><view class="status--text data-v-a9ca07ae">交易关闭</view><view style=";" class="data-v-a9ca07ae">{{order.getOrderStatusTips(detail.status)}}</view></view></block><block wx:else><block wx:if="{{order.isPendingPayment(detail.status)}}"><view class="data-v-a9ca07ae"><view class="status--text data-v-a9ca07ae">等待买家付款</view><view class="status--description data-v-a9ca07ae"><text class="data-v-a9ca07ae">剩</text><van-count-down style="color:#FFFFFF;" vue-id="bf89dbc6-3" time="{{detail.expireTime}}" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-count-down><text class="data-v-a9ca07ae">自动关闭</text></view></view></block><block wx:else><view class="data-v-a9ca07ae"><view class="status--text data-v-a9ca07ae">{{order.getOrderStatusName(detail.status)}}</view></view></block></block><view class="data-v-a9ca07ae"><view class="{{['_i data-v-a9ca07ae','iconfont '+helper.getStatusIcon(detail.status)]}}"></view></view></block></view><view class="order--receiver data-v-a9ca07ae"><van-cell-group vue-id="bf89dbc6-4" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l" vue-slots="{{['default']}}"><van-cell vue-id="{{('bf89dbc6-5')+','+('bf89dbc6-4')}}" title="配送方式" value="{{order.getDeliveryTypeName(detail.orderDelivery.deliveryType)}}" value-class="logistic--type" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l" vue-slots="{{['icon']}}"><view class="iconfont icondingdanxiangqing-wuliu data-v-a9ca07ae" slot="icon"></view></van-cell><block wx:if="{{steps.length}}"><van-cell vue-id="{{('bf89dbc6-6')+','+('bf89dbc6-4')}}" title="{{steps[0]&&steps[0].context}}" label="{{steps[0]&&steps[0].time}}" title-class="logistic--detail" is-link="{{true}}" data-event-opts="{{[['^tap',[['goDeliveryDetail']]]]}}" data-com-type="wx" bind:tap="__e" class="data-v-a9ca07ae" bind:__l="__l" vue-slots="{{['icon']}}"><view class="iconfont icondingdanxiangqing-wuliu data-v-a9ca07ae" slot="icon"></view></van-cell></block><block wx:if="{{detail.orderDelivery.deliveryType==='LOGISTICS'}}"><van-cell vue-id="{{('bf89dbc6-7')+','+('bf89dbc6-4')}}" title="{{'收货人：'+detail.orderDelivery.receiverName}}" value="{{detail.orderDelivery.receiverPhone}}" label="{{'取货地址：'+helper.getAddress(detail.orderDelivery)}}" label-class="addr" value-class="phone" custom-class="receiver-info" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l" vue-slots="{{['icon']}}"><view class="iconfont icongerenzhongxin-dizhiguanli data-v-a9ca07ae" slot="icon"></view></van-cell></block><block wx:else><van-cell vue-id="{{('bf89dbc6-8')+','+('bf89dbc6-4')}}" center="{{true}}" title="{{detail.orderDelivery.receiverName+' '+detail.orderDelivery.receiverPhone}}" label="{{helper.getAddress(detail.orderDelivery)}}" label-class="addr" value-class="phone" title-class="cell-style" label-style="cell-style" custom-class="receiver-info" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l" vue-slots="{{['default','icon']}}"><view class="iconfont icongerenzhongxin-dizhiguanli data-v-a9ca07ae" slot="icon"></view><block wx:if="{{helper.canUpdateAddress(detail.status)}}"><van-button class="addr__button data-v-a9ca07ae" vue-id="{{('bf89dbc6-9')+','+('bf89dbc6-8')}}" slot="right-icon" data-item="{{detail.orderDelivery}}" color="#FF4E63" plain="{{true}}" size="mini" data-event-opts="{{[['^tap',[['handleChangeAddress']]]]}}" data-com-type="wx" bind:tap="__e" bind:__l="__l" vue-slots="{{['default']}}">修改</van-button></block></van-cell></block></van-cell-group></view><block wx:if="{{detail.userNote}}"><view class="order--message data-v-a9ca07ae"><view class="message--l data-v-a9ca07ae"><image class="message--icon data-v-a9ca07ae" src="https://medusa-small-file.oss-cn-hangzhou.aliyuncs.com/images/message-icon.png"></image></view><view class="message--r data-v-a9ca07ae"><view class="message--label data-v-a9ca07ae">买家留言</view><view class="message--content data-v-a9ca07ae">{{detail.userNote}}</view></view></view></block><view class="order--goods data-v-a9ca07ae"><block wx:for="{{detail.orderItemList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="data-v-a9ca07ae"><view data-id="{{item.productId}}" data-img="{{item.productPic}}" data-event-opts="{{[['tap',[['goGoods',['$event']]]]]}}" bindtap="__e" class="data-v-a9ca07ae"><goods vue-id="{{'bf89dbc6-10-'+index}}" goodsData="{{item}}" class="data-v-a9ca07ae" bind:__l="__l"></goods></view><block wx:if="{{after.userApplyBtnVisible(detail.status,item.afs)&&after.applyNumNotExceeded(item.afs,item.applyNum)&&!detail.expire}}"><block class="data-v-a9ca07ae"><block wx:if="{{after.userApplyVisible(item.afs)||after.isRevoke(item.afs)}}"><view class="a__btn data-v-a9ca07ae" data-actions="{{after.afterActions('user',detail.status,detail.orderDelivery.deliveryType==='LOGISTICS')}}" data-afs="{{item.afs}}" data-goods="{{item}}" data-event-opts="{{[['tap',[['handleApply',['$event']]]]]}}" bindtap="__e">{{''+(after.afterActions('user',detail.status,detail.orderDelivery.deliveryType==='LOGISTICS').length===1?'申请退款':'申请售后')+''}}</view></block><block wx:else><block class="data-v-a9ca07ae"><view class="a__btn data-v-a9ca07ae" data-goods="{{item}}" data-afsid="{{item.afs.id}}" data-event-opts="{{[['tap',[['goAfterDetail',['$event']]]]]}}" bindtap="__e">{{''+after.getAfterTypeName(item.afs.type)+"\n\t\t\t\t\t\t\t"+after.getAfterStatusName(item.afs.status)+''}}</view></block></block></block></block></view></block></view><block wx:if="{{detail.couponAmount}}"><van-cell vue-id="bf89dbc6-11" title="优惠券" value="{{'-￥'+detail.couponAmount}}" value-class="price" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-cell></block><block wx:if="{{detail.fullScaleAmount}}"><van-cell vue-id="bf89dbc6-12" title="满减优惠" value="{{'-￥'+detail.fullScaleAmount}}" value-class="price" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-cell></block><block wx:if="{{detail.memberAmount}}"><van-cell vue-id="bf89dbc6-13" title="会员本单立省" value="{{detail.memberAmount}}" value-class="price" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-cell></block><block wx:if="{{detail.integrationAmount}}"><van-cell vue-id="bf89dbc6-14" title="积分抵扣" value="{{'-￥'+detail.integrationAmount}}" value-class="price" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-cell></block><block wx:if="{{detail.freightAmount}}"><van-cell vue-id="bf89dbc6-15" title="配送费" value="{{detail.freightAmountstr}}" value-class="price" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-cell></block><van-cell vue-id="bf89dbc6-16" title="支付总金额" value="{{'¥'+detail.payAmount}}" value-class="price" custom-class="order-price" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-cell><block wx:for="{{customForm}}" wx:for-item="item" wx:for-index="index" wx:key="index"><block class="data-v-a9ca07ae"><block wx:if="{{item.value}}"><block class="data-v-a9ca07ae"><block wx:if="{{formHelper.isInputItem(item.type)}}"><van-cell vue-id="{{'bf89dbc6-17-'+index}}" title="{{item.key}}" value="{{item.value}}" custom-class="order-price" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-cell></block><block wx:else><block wx:if="{{formHelper.isDateItem(item.type)}}"><van-cell vue-id="{{'bf89dbc6-18-'+index}}" title="{{item.key}}" value="{{item.time}}" custom-class="order-price" data-com-type="wx" class="data-v-a9ca07ae" bind:__l="__l"></van-cell></block><block wx:else><van-cell vue-id="{{'bf89dbc6-19-'+index}}" data-item="{{item}}" title="{{item.key}}" is-link="{{true}}" value="点击查看" border="{{false}}" data-event-opts="{{[['^tap',[['handleSeePhoto']]]]}}" data-com-type="wx" bind:tap="__e" class="data-v-a9ca07ae" bind:__l="__l"></van-cell></block></block></block></block></block></block><view class="order--info data-v-a9ca07ae"><view class="data-v-a9ca07ae">{{"订单编号："+detail.id}}</view><view class="data-v-a9ca07ae">{{"支付方式："+order.getPayTypeName(detail.payType)}}</view><view class="data-v-a9ca07ae">{{"创建时间："+detail.createTime}}</view><block wx:if="{{detail.payTime}}"><view class="data-v-a9ca07ae">{{"付款时间："+detail.payTime}}</view></block><block wx:if="{{detail.orderDelivery.deliveryTime}}"><view class="data-v-a9ca07ae">{{'发货时间：'+detail.orderDelivery.deliveryTime+''}}</view></block><block wx:if="{{detail.closeTime}}"><view class="data-v-a9ca07ae">{{"关闭时间："+detail.closeTime}}</view></block><block wx:if="{{detail.commentTime}}"><view class="data-v-a9ca07ae">{{"评价时间："+detail.commentTime}}</view></block><block wx:if="{{detail.orderDelivery.receiveTime}}"><view class="data-v-a9ca07ae">{{'成交时间：'+detail.orderDelivery.receiveTime+''}}</view></block></view><block wx:if="{{userType==='MALL'}}"><view class="order--buttons data-v-a9ca07ae"><block wx:if="{{order.isPendingPayment(detail.status)}}"><block class="data-v-a9ca07ae"><button data-event-opts="{{[['tap',[['backHome',['$event']]]]]}}" class="button--item data-v-a9ca07ae" bindtap="__e">返回首页</button><button data-event-opts="{{[['tap',[['pay',[['o',['id',detail.id],['type','']],'$0'],['callbackAction']]]]]}}" class="button--item primary data-v-a9ca07ae" bindtap="__e">立即付款</button></block></block><block wx:else><block wx:if="{{order.isClose(detail.status)}}"><block class="data-v-a9ca07ae"><button data-event-opts="{{[['tap',[['backHome',['$event']]]]]}}" class="button--item data-v-a9ca07ae" bindtap="__e">返回首页</button><button data-event-opts="{{[['tap',[['buyAgain',['$event']]]]]}}" class="button--item primary data-v-a9ca07ae" bindtap="__e">再次购买</button></block></block><block wx:else><block wx:if="{{order.isWaitTake(detail.status)}}"><block class="data-v-a9ca07ae"><button data-event-opts="{{[['tap',[['backHome',['$event']]]]]}}" class="button--item data-v-a9ca07ae" bindtap="__e">返回首页</button><block wx:if="{{!detail.rBtnStatus}}"><button data-event-opts="{{[['tap',[['receipt',[['o',['id',detail.id],['disabled',false]],'$0'],['callbackAction']]]]]}}" class="button--item primary data-v-a9ca07ae" bindtap="__e">确认收货</button></block></block></block><block wx:else><block wx:if="{{order.isWaitComment(detail.status)}}"><block class="data-v-a9ca07ae"><button data-event-opts="{{[['tap',[['backHome',['$event']]]]]}}" class="button--item data-v-a9ca07ae" bindtap="__e">返回首页</button><block wx:if="{{hasOpenEvaluate}}"><button class="button--item primary data-v-a9ca07ae" data-id="{{detail.id}}" data-event-opts="{{[['tap',[['goReviews',['$event']]]]]}}" bindtap="__e">立即评价</button></block></block></block><block wx:else><block class="data-v-a9ca07ae"><button data-event-opts="{{[['tap',[['backHome',['$event']]]]]}}" class="button--item data-v-a9ca07ae" bindtap="__e">返回首页</button></block></block></block></block></block></view></block><van-action-sheet vue-id="bf89dbc6-20" title="申请售后" show="{{sheetVisible}}" actions="{{after.afterActions('user',detail.status,detail.orderDelivery.deliveryType==='LOGISTICS')}}" data-event-opts="{{[['^close',[['onClose']]],['^select',[['onSelect']]]]}}" data-com-type="wx" bind:close="__e" bind:select="__e" class="data-v-a9ca07ae" bind:__l="__l"></van-action-sheet></view>